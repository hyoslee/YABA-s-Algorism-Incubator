package com.yaba.demo.controller;


import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;
import org.springframework.web.bind.annotation.PathVariable;
import org.apache.commons.math3.stat.descriptive.moment.Mean;
import org.apache.commons.math3.stat.descriptive.moment.StandardDeviation;
import org.apache.commons.math3.stat.descriptive.summary.Sum;
import org.json.JSONArray;
import org.json.JSONObject;
import org.json.XML;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.http.client.HttpComponentsClientHttpRequestFactory;

import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.net.MalformedURLException;
import java.net.URI;
import java.net.URL;
import java.nio.charset.Charset;
import java.security.cert.X509Certificate;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.web.context.request.RequestContextHolder;
import org.springframework.web.context.request.ServletRequestAttributes;
import org.springframework.web.util.UriComponentsBuilder;

import com.yaba.demo.vo.ELS;
import com.yaba.demo.vo.Yaba;
import com.fasterxml.jackson.databind.util.JSONPObject;
import com.yaba.demo.mapper.YabaMapper;

@RestController
public class HelloYaba {
	@Autowired YabaMapper yabaMapper ;

//	public String[] eArr= {"317330"};
	public String[] eArr= {"311390", "195500", "328380", "286750", "317830", "228670", "186230", "327970", "282880", "317330", "318000", "148150", "313760", "317850", "241840", "300080", "323210", "329050", "234340", "289010", "327610", "251970", "312610", "309900", "323280", "323940", "323230", "293780", "308100", "305090", "278380", "322780", "321260", "003670", "253840", "307930", "323350", "319660", "319400", "950180", "317320", "317240", "279060", "125210", "228760", "317030", "099750", "313750", "100790", "192650", "192080", "247540", "299660", "316140", "278280", "246960", "053580", "311060", "311840", "298690", "238200", "314130", "311270", "310840", "263050", "290550", "310200", "307180", "308700", "309930", "299900", "310870", "307750", "298380", "303360", "100590", "110020", "270870", "307870", "302430", "307070", "290120", "307280", "128540", "299910", "271780", "900340", "307160", "111710", "179290", "117730", "290660", "207490", "246710", "288490", "267850", "263690", "027360", "208340", "263020", "122050", "227100", "268600", "285490", "290650", "306620", "108490", "153710", "288620", "306200", "293580", "290720", "293480", "110790", "299170", "219750", "010400", "257370", "291230", "140610", "197140", "303030", "290740", "173130", "089970", "086820", "302550", "302920", "290380", "293940", "275630", "290270", "091810", "286940", "080720", "204020", "297570", "226950", "258050", "298040", "298050", "298020", "298000", "175250", "289080", "276240", "299480", "088260", "245620", "299670", "284620", "037030", "016790", "258830", "122310", "163430", "291210", "086080", "287410", "217910", "950170", "065370", "263700", "018250", "064510", "277070", "226400", "183490", "006620", "154030", "260660", "068270", "042000", "219420", "267790", "255220", "264660", "284740", "285130", "269620", "284610", "285770", "281410", "187870", "281310", "236030", "281740", "284420", "282330", "092780", "272450", "260930", "234300", "281820", "066360", "007680", "138580", "282690", "279410", "253450", "276920", "279600", "148140", "950160", "055490", "278990", "180060", "265560", "234100", "277480", "263810", "255440", "277410", "263920", "243840", "179900", "171090", "259630", "174900", "270020", "256940", "260870", "263600", "267060", "258610", "270520", "140670", "900310", "273060", "118990", "263860", "263720", "091990", "181340", "162120", "270660", "271740", "238490", "271980", "251630", "227610", "233250", "261200", "267320", "271850", "270210", "266170", "250000", "265920", "225190", "264850", "161580", "265480", "224880", "268280", "251270", "079440", "267270", "267260", "267250", "264290", "267810", "251370", "258790", "225860", "266870", "264900", "263770", "063760", "264450", "178320", "183300", "246720", "145720", "262830", "217480", "002800", "083500", "087260", "257730", "241820", "111110", "140070", "206650", "205290", "260970", "256840", "227420", "120780", "242350", "195440", "241520", "246690", "258250", "147760", "204990", "199290", "196300", "203450", "215600", "254120", "241790", "220100", "144960", "156100", "258540", "232830", "176440", "232330", "148780", "237880", "900300", "238120", "252500", "243870", "216050", "239610", "241710", "234080", "900290", "251280", "900280", "189300", "072990", "238090", "050960", "201490", "241590", "252370", "250930", "229640", "204210", "241690", "250060", "251960", "242040", "234920", "249420", "900270", "239890", "248170", "230360", "191600", "038160", "016740", "208860", "073560", "212310", "224020", "123010", "066830", "174880", "071460", "123890", "034830", "247300", "142760", "237750", "900260", "246250", "245450", "195870", "144510", "148250", "208850", "239340", "243070", "244880", "112190", "070960", "101530", "240810", "058970", "241510", "240340", "238500", "228850", "225330", "228340", "004440", "222110", "222160", "211270", "230980", "115180", "065660", "236200", "226350", "142210", "900250", "221610", "236340", "067370", "206950", "232530", "109610", "233990", "224060", "152330", "226320", "135160", "215570", "232140", "191410", "223310", "145020", "222980", "206560", "013310", "217730", "047920", "234070", "133750", "226610", "225530", "140860", "230240", "122640", "222040", "232680", "058110", "044990", "225850", "217820", "213090", "075580", "221840", "197210", "127160", "221980", "212560", "227950", "230400", "185490", "211050", "190510", "056090", "214330", "089590", "226340", "217950", "115960", "092590", "229500", "182400", "092870", "226360", "228180", "224810", "200580", "214870", "225430", "226440", "225590", "079550", "225570", "217190", "219130", "002690", "175140", "220250", "225650", "222080", "220630", "224110", "196700", "095570", "131760", "222810", "222800", "189980", "094360", "225220", "127710", "214430", "222670", "220260", "214450", "219550", "087010", "214320", "214420", "086220", "223220", "218410", "094170", "214180", "178780", "214390", "216400", "221800", "160600", "217600", "166480", "214310", "210980", "214610", "103660", "177350", "218150", "160980", "217500", "087600", "217620", "187420", "217880", "076340", "215380", "215480", "215790", "215360", "215200", "217320", "215090", "215100", "195990", "215000", "214150", "215050", "214270", "145210", "189690", "213420", "213500", "210540", "060480", "176750", "206640", "193250", "204630", "200470", "200670", "200350", "208710", "189860", "067390", "080580", "208350", "124500", "210610", "208890", "142280", "187220", "135270", "208370", "208140", "149980", "084650", "210120", "200710", "200780", "207760", "196170", "206400", "178920", "150440", "205470", "112610", "200230", "194510", "204620", "196490", "018260", "149010", "205500", "205100", "191420", "192440", "182690", "143540", "121060", "203650", "041920", "194480", "203690", "192410", "198440", "202960", "187270", "192400", "177830", "090410", "004650", "192390", "059120", "133820", "203400", "105550", "199150", "199800", "196450", "071850", "027410", "187790", "192250", "192820", "138080", "108790", "053300", "084440", "090850", "140660", "189330", "189540", "189350", "184230", "178600", "140290", "049080", "150840", "107640", "085810", "185750", "170030", "134580", "171120", "171010", "161570", "183410", "138360", "183190", "076610", "168330", "185190", "131970", "150900", "183350", "170920", "119850", "180640", "092040", "181710", "170790", "151860", "089600", "114920", "126340", "158300", "086460", "064850", "179720", "101360", "116100", "950130", "141080", "168490", "158310", "097800", "159580", "114810", "153490", "141020", "159910", "950110", "046970", "113810", "013870", "141070", "155650", "037560", "149950", "163560", "161890", "121850", "161000", "159650", "151910", "097520", "153460", "106520", "137400", "155900", "014710", "141000", "153360", "144620", "072950", "152550", "079980", "143240", "126870", "147830", "091590", "145270", "140410", "104830", "127120", "007070", "130580", "131090", "100660", "115480", "145990", "123260", "139670", "121800", "112240", "138070", "122870", "136510", "089530", "089030", "101240", "007820", "115530", "039130", "043290", "090360", "131220", "131390", "143160", "078520", "137950", "040910", "139050", "023000", "089980", "031430", "140910", "138610", "108380", "047810", "071840", "019770", "138490", "137940", "131100", "139130", "053210", "138690", "019440", "122450", "121440", "138040", "136540", "136480", "104480", "020150", "008470", "011210", "136490", "134380", "121600", "093320", "130740", "131180", "061970", "126880", "033560", "048530", "134790", "119860", "131370", "064290", "131290", "082740", "131400", "126560", "120240", "130660", "131030", "096690", "900140", "033830", "033170", "122800", "041460", "105740", "126600", "123420", "123860", "058400", "030790", "069140", "119830", "101930", "078650", "068940", "123840", "117670", "068240", "057050", "096530", "122990", "126700", "126640", "123410", "002150", "123040", "067920", "128820", "122900", "128940", "119610", "106190", "105840", "114120", "033920", "121890", "103130", "111820", "046120", "102460", "070300", "108320", "079970", "123690", "123700", "071200", "100030", "122690", "900110", "900100", "115500", "900120", "115450", "122350", "115610", "120030", "106080", "101330", "114570", "120110", "119650", "071320", "115390", "115570", "115440", "050860", "012160", "114630", "080530", "118000", "900070", "099520", "114450", "104460", "096640", "112040", "052690", "108860", "900080", "088290", "114190", "114090", "115160", "109960", "034730", "099410", "101000", "032560", "082920", "000080", "042520", "082640", "104200", "052860", "047400", "105330", "093240", "109740", "095700", "108230", "100130", "103230", "039490", "063080", "109860", "033660", "028100", "102120", "101730", "900040", "102710", "099440", "102210", "099220", "101680", "071970", "010240", "101170", "081150", "108670", "071670", "101490", "100120", "102940", "101400", "109070", "107590", "086890", "104040", "078070", "086900", "058630", "059100", "067630", "092130", "026940", "100700", "104700", "098120", "083470", "100090", "103590", "103140", "101390", "076080", "101670", "017180", "063170", "047560", "100220", "096240", "102260", "101160", "099320", "102280", "064480", "098460", "018620", "095610", "096870", "059210", "097870", "087730", "101140", "101060", "100840", "100250", "091440", "099340", "099350", "096040", "085310", "097780", "096630", "068330", "093920", "096350", "051600", "069920", "096610", "092070", "094820", "086670", "093230", "095190", "044450", "094280", "092300", "033270", "093640", "092200", "095910", "081580", "073110", "094970", "080520", "095340", "086040", "090740", "057540", "094940", "095270", "097230", "093190", "096760", "091340", "096770", "072770", "094480", "086520", "065150", "069410", "096300", "001780", "093380", "095720", "086450", "064820", "091580", "092460", "073540", "091120", "094860", "094800", "078020", "093520", "048260", "091970", "092730", "090460", "039200", "089010", "090470", "088130", "090370", "084110", "091700", "086390", "090710", "093050", "060540", "066310", "067280", "044380", "044820", "086250", "089890", "080470", "089140", "089790", "090150", "009770", "092230", "089230", "043150", "086960", "038060", "091090", "083660", "062860", "063570", "086980", "068050", "085370", "039290", "090350", "078860", "088910", "032350", "054950", "049800", "084730", "035510", "086060", "022220", "088790", "023530", "068760", "083450", "019990", "079370", "046110", "085670", "084370", "083790", "064550", "084990", "083640", "085660", "086280", "078140", "067900", "083550", "084870", "084180", "086790", "050540", "001560", "080420", "083650", "079190", "045890", "079430", "082800", "043910", "079000", "041020", "078590", "038070", "083420", "079940", "077360", "083930", "067310", "082660", "080010", "083370", "083380", "084690", "058220", "071950", "078160", "082850", "080160", "084670", "042700", "078890", "004890", "082210", "075130", "080440", "010960", "073240", "073490", "079960", "080220", "079170", "079810", "079650", "052900", "066910", "052460", "079160", "081000", "072870", "073010", "078600", "054450", "078150", "067990", "014830", "051360", "072520", "041650", "078130", "068790", "023810", "078940", "048870", "065350", "078930", "058730", "034220", "011080", "050090", "057030", "065770", "074430", "077280", "066700", "066900", "078350", "075970", "069540", "073190", "054090", "041910", "034310", "073070", "039670", "067770", "070590", "073570", "073640", "065680", "057880", "074610", "060570", "066410", "067160", "071280", "041440", "067170", "054780", "025750", "072020", "065510", "072470", "068930", "069110", "007660", "035250", "069330", "037270", "052710", "072710", "065950", "047310", "071050", "056000", "041520", "065560", "072130", "034120", "064240", "066790", "036570", "071090", "067080", "066590", "067290", "066130", "046140", "065450", "065130", "069730", "065440", "006890", "049630", "021650", "051370", "065650", "065570", "066980", "016100", "011500", "065940", "042040", "066970", "066670", "066430", "047820", "064090", "049960", "053290", "064520", "065170", "069460", "069620", "041590", "027740", "036530", "069260", "042600", "033530", "065500", "060900", "066620", "065420", "052770", "064800", "058430", "039980", "048410", "068290", "067830", "058610", "045340", "030610", "065710", "065690", "066110", "043710", "060560", "036010", "060280", "065620", "060230", "057680", "046940", "034300", "060150", "065530", "017370", "051160", "065060", "049180", "060720", "061040", "054210", "050120", "054410", "060310", "061250", "053980", "024720", "054050", "039420", "064960", "039440", "049550", "054670", "060590", "049070", "060370", "051380", "053660", "037710", "034950", "060260", "060380", "046310", "058530", "049720", "052670", "046890", "013990", "058450", "059090", "050320", "054930", "035200", "048470", "060300", "042500", "058420", "040350", "054300", "054340", "047080", "020760", "060250", "053260", "060240", "056730", "041930", "054220", "033180", "058470", "045300", "056700", "054940", "043370", "063160", "054620", "056360", "043260", "038340", "051390", "054540", "054630", "056080", "044490", "053950", "053700", "054920", "041960", "053160", "052400", "054180", "049470", "053050", "043090", "053110", "054800", "047770", "055550", "040300", "058820", "035900", "053590", "021320", "053060", "053610", "053450", "053030", "052420", "021240", "053620", "052300", "048910", "051980", "058650", "049120", "043360", "052330", "052020", "043220", "051780", "052190", "051490", "038870", "045660", "052260", "045390", "050110", "051900", "047050", "042660", "038500", "051630", "049830", "044060", "024850", "048770", "049430", "044480", "046390", "014620", "048430", "017480", "049480", "036670", "042510", "046070", "041830", "014570", "045520", "022100", "049770", "033600", "044180", "044960", "032080", "034020", "044340", "042940", "010040", "048830", "000250", "044780", "045510", "045100", "040160", "043340", "043650", "037950", "039030", "038540", "018680", "039860", "046210", "045060", "043100", "042370", "045970", "040420", "007370", "043610", "039010", "043200", "042110", "039740", "039840", "038460", "039230", "032820", "001540", "038530", "039310", "041190", "036640", "030190", "038620", "039020", "038950", "036800", "040610", "038880", "038680", "010280", "036480", "038110", "032500", "039610", "039240", "037440", "028150", "036810", "036690", "037370", "036620", "037350", "001810", "036630", "036710", "037070", "036560", "016250", "036030", "035890", "036930", "032190", "005290", "036170", "036180", "026040", "037230", "037400", "003220", "036460", "033640", "037330", "036090", "036200", "024800", "036260", "027050", "035290", "027040", "027830", "036000", "007120", "035810", "035460", "035480", "000850", "033780", "009540", "024090", "035620", "035610", "020710", "012790", "034940", "006840", "006650", "035150", "035000", "033250", "033230", "035080", "005160", "033240", "019490", "031390", "033430", "025770", "033540", "033500", "029460", "030350", "033310", "033320", "009520", "013810", "033340", "024890", "033200", "033290", "015710", "017940", "018670", "023590", "014440", "033100", "033050", "033110", "033130", "032980", "019210", "026150", "031310", "011790", "032960", "032680", "032940", "008290", "010600", "025890", "032750", "032860", "032790", "032800", "024900", "023960", "023800", "032620", "032580", "032540", "028080", "032280", "025530", "031510", "031820", "031860", "031980", "000660", "023150", "005320", "023450", "016800", "011560", "024740", "024070", "030720", "025560", "030210", "030960", "017900", "025540", "030520", "021880", "021040", "029480", "003160", "011930", "019180", "028040", "028300", "027710", "021820", "027970", "006740", "000910", "020120", "016580", "023600", "018310", "003800", "013580", "011160", "021050", "012750", "015890", "027390", "025980", "026910", "017250", "016590", "011690", "025860", "018500", "011300", "015750", "020180", "012610", "017810", "011200", "017390", "025820", "025950", "025900", "011090", "007460", "025620", "017960", "025870", "025880", "002680", "025550", "025320", "024940", "024950", "014100", "024840", "024910", "004780", "013120", "024830", "024810", "024880", "025000", "010580", "007980", "024120", "017000", "024060", "023910", "001840", "023900", "023890", "017650", "010170", "023790", "023770", "023760", "005860", "009440", "008420", "016880", "012860", "023460", "006050", "023410", "023440", "006910", "018290", "023160", "007310", "008500", "014790", "010120", "011370", "009190", "000760", "014820", "018700", "014470", "009680", "010690", "007720", "006580", "011320", "018120", "013720", "009620", "005670", "007330", "006140", "019010", "009780", "000390", "017680", "008800", "009450", "020400", "014200", "005710", "016600", "004590", "016670", "000440", "012030", "005090", "014970", "005750", "011040", "008370", "007390", "002290", "019540", "007770", "017890", "003310", "019660", "005880", "008560", "017510", "005870", "017550", "021080", "011170", "008830", "001430", "008770", "014580", "013520", "006060", "014530", "002140", "002230", "016090", "001620", "017040", "011390", "011810", "010130", "009730", "012600", "001500", "008870", "008110", "005820", "008490", "014910", "003580", "015860", "014160", "012280", "019170", "002210", "016920", "012170", "009420", "013030", "011330", "012800", "013360", "001140", "013700", "002760", "007610", "004920", "009290", "011420", "004270", "001940", "009410", "007280", "009180", "002170", "017670", "010640", "003650", "004380", "002840", "007860", "019550", "013000", "012330", "015540", "009320", "005440", "015760", "006280", "009160", "008600", "015230", "007160", "014130", "008040", "009140", "014990", "010420", "003610", "015590", "014680", "019570", "019590", "006040", "008060", "003680", "006920", "015020", "011280", "002310", "010660", "001770", "018470", "005850", "012510", "007630", "008250", "006370", "006980", "002920", "002220", "002450", "002460", "007340", "000890", "001290", "003010", "014280", "009810", "008730", "009270", "004140", "002960", "005810", "001270", "004710", "005190", "016610", "008930", "005500", "005490", "002410", "005690", "006340", "005950", "016360", "002810", "001750", "011780", "003470", "002620", "015260", "009460", "005720", "006660", "004490", "011000", "010100", "005070", "004830", "001720", "001200", "003460", "011700", "005420", "000500", "011230", "004020", "004770", "006090", "009470", "001510", "016380", "010780", "007810", "004170", "010060", "000520", "006490", "003120", "002710", "003060", "007700", "008700", "006360", "006110", "006400", "009150", "004200", "005960", "009070", "003070", "005180", "005250", "005450", "004310", "008350", "003350", "001880", "006260", "001740", "002100", "004870", "007590", "004430", "002780", "004090", "000650", "001080", "004700", "004360", "008970", "002880", "001260", "005680", "005800", "002630", "001550", "005430", "004910", "004690", "003080", "002600", "001570", "002070", "003570", "004960", "004370", "003720", "004980", "004970", "002870", "001630", "005740", "002390", "001380", "006120", "007540", "003280", "001250", "002990", "001470", "001820", "001020", "001520", "001060", "000670", "001340", "000180", "005110", "004450", "000040", "002240", "004100", "002820", "004840", "002350", "004060", "004000", "000020", "000210", "001120", "005030", "000590", "005390", "000990", "000220", "005940", "006800", "002700", "001360", "000810", "000370", "008260", "000490", "004540", "001420", "002020", "000300", "001460", "003620", "003410", "005610", "010050", "007570", "002320", "002200", "005380", "005360", "009830", "002030", "001070", "004410", "000680", "001210", "000140", "000320", "000270", "004800", "000150", "005010", "005830", "003090", "003780", "003520", "002380", "003200", "006220", "004150", "007210", "002300", "000400", "001130", "001680", "003550", "003690", "000970", "004250", "003030", "001440", "001790", "000070", "002420", "000950", "001530", "000120", "000060", "000050", "000700", "003480"};
	public Integer idxLong = 300;
	public Integer adj = 5;

	//	@RequestMapping("/{teamcd}")
	//	public List<Yaba> Yaba(@PathVariable String teamcd) {
	//
	//		HttpServletRequest req = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest();
	//		Object certChain = req.getAttribute("javax.servlet.request.X509Certificate");
	//
	//		String certName = null;
	//
	//		if (certChain != null) {
	//			X509Certificate certs[] = (X509Certificate[])certChain;
	//
	//			for(int i = 0; i < certs.length; i++) {
	//				X509Certificate cert = certs[i];
	//				certName = cert.getSubjectDN().getName();
	//				System.out.println(certName);
	//			}
	//		}
	//
	//		Yaba obj = new Yaba();
	//		obj.setTeamcd(teamcd);
	//
	//		List<Yaba> yaba = yabaMapper.readTeaminfo(teamcd);
	//
	//		return yaba;
	//	}

	@RequestMapping("/REST")
	public void getYaba() {
		for(int i=0;i<eArr.length;i++){
			getELS(eArr[i]);
		}
	}

	public void getELS(String itm) {
		String ELS = null;

		URI uri = UriComponentsBuilder.newInstance().scheme("https").host("fchart.stock.naver.com")
				.path("/sise.nhn")
				.queryParam("symbol", itm)
				.queryParam("timeframe", "day")
				.queryParam("count", idxLong.toString())
				.queryParam("requestType", "0")
				.build()
				.encode(Charset.forName("UTF-8"))
				.toUri();

		String html = getHtml(uri.toString());

		JSONObject json = XML.toJSONObject(html);
		JSONObject jRoot = (JSONObject)json.get("protocol");
		JSONObject jItem = (JSONObject)jRoot.get("chartdata");
		JSONArray jArr = (JSONArray) jItem.get("item");

		StandardDeviation cStd = new StandardDeviation();
		StandardDeviation aStd = new StandardDeviation();

		Mean cMean = new Mean();
		Mean aMean = new Mean();
		
		Sum cR1 = new Sum();
		Sum cR2 = new Sum();
		Sum aR1 = new Sum();
		Sum aR2 = new Sum();
		
		Double cA = 0.0;	// linear A
		Double cB = 0.0;	// linear B

		Double aA = 0.0;	// linear A
		Double aB = 0.0;	// linear B

		// Calc Std & Mean
		for(int i=0;i<jArr.length()-adj;i++){
			JSONObject jsonObj2 = (JSONObject)jArr.get(i);
			String jData = (String)jsonObj2.get("data");

			Double cVal = Double.parseDouble(jData.split("\\|")[4]);
			Double aVal = Double.parseDouble(jData.split("\\|")[5]);

			if(eArr.length <= adj) System.out.println(cVal);
			
			cStd.increment(cVal);
			cMean.increment(cVal);
			aStd.increment(aVal);
			aMean.increment(aVal);
		}

		for(int i=0;i<jArr.length()-adj;i++){
			JSONObject jsonObj2 = (JSONObject)jArr.get(i);
			String jData = (String)jsonObj2.get("data");

			Double cVal = Double.parseDouble(jData.split("\\|")[4]);
			Double aVal = Double.parseDouble(jData.split("\\|")[5]);

			cR1.increment((i + 1 - (jArr.length()-adj)/2 + 0.5) * (cVal - cMean.getResult()));
			cR2.increment((i + 1 - (jArr.length()-adj)/2 + 0.5) * (i + 1 - (jArr.length()-adj)/2 + 0.5));
			aR1.increment((i + 1 - (jArr.length()-adj)/2 + 0.5) * (aVal - aMean.getResult()));
			aR2.increment((i + 1 - (jArr.length()-adj)/2 + 0.5) * (i + 1 - (jArr.length()-adj)/2 + 0.5));
		}

		cB = cR1.getResult()/cR2.getResult();
		cA = cMean.getResult() - cB * ((jArr.length()-adj)/2 + 0.5);
		
		aB = aR1.getResult()/aR2.getResult();
		aA = aMean.getResult() - aB * ((jArr.length()-adj)/2 + 0.5);

		JSONObject jsonObj2 = (JSONObject)jArr.get(jArr.length()-1-adj);
		String jData = (String)jsonObj2.get("data");

		if(eArr.length <= 5) {
			System.out.println("#|" + itm);
			
			System.out.println("A|" + cA);
			System.out.println("B|" + cB);
			System.out.println("Mean|" + cMean.getResult());
			System.out.println("Std|" + cStd.getResult());
			System.out.println("B-Index|" + Math.round((Double.parseDouble(jData.split("\\|")[4]) - cMean.getResult()) / (2*cStd.getResult()) * 10000)/1000.0);
			
			System.out.println("A|" + aA);
			System.out.println("B|" + aB);
			System.out.println("Mean|" + aMean.getResult());
			System.out.println("Std|" + aStd.getResult());
			System.out.println("B-Index|" + Math.round((Double.parseDouble(jData.split("\\|")[5]) - aMean.getResult()) / (2*aStd.getResult()) * 10000)/1000.0);
			
			System.out.println("|" + Double.parseDouble(jData.split("\\|")[4]));
			
			JSONObject jsonObj3 = (JSONObject)jArr.get(jArr.length()-1);
			String jData3 = (String)jsonObj3.get("data");
			
			System.out.println("|" + Double.parseDouble(jData3.split("\\|")[4]));
		}else {
			System.out.print(itm);
			System.out.print("|" + cA);
			System.out.print("|" + cB);
			System.out.print("|" + cMean.getResult());
			System.out.print("|" + cStd.getResult());
			System.out.print("|" + Math.round((Double.parseDouble(jData.split("\\|")[4]) - cMean.getResult()) / (2*cStd.getResult()) * 10000)/1000.0);
			System.out.print("|" + aA);
			System.out.print("|" + aB);
			System.out.print("|" + aMean.getResult());
			System.out.print("|" + aStd.getResult());
			System.out.print("|" + Math.round((Double.parseDouble(jData.split("\\|")[5]) - aMean.getResult()) / (2*aStd.getResult()) * 10000)/1000.0);
			
			System.out.print("|" + Double.parseDouble(jData.split("\\|")[4]));
			
			JSONObject jsonObj3 = (JSONObject)jArr.get(jArr.length()-1);
			String jData3 = (String)jsonObj3.get("data");
			
			System.out.println("|" + Double.parseDouble(jData3.split("\\|")[4]));
		}
	}

//	JSONObject jsonObject = new JSONObject();
//
//    jsonObject.put("SECR_KEY", "ktko.tistory.com");
//    jsonObject.put("KEY", "ktko");
//    
//    JSONObject data = new JSONObject();
//    data.put("BANK_CD", "088");
//    data.put("SEARCH_ACCT_NO", "1231231234");
//    data.put("ACNM_NO", "123456");
//    data.put("ICHE_AMT", "0");
//    data.put("TRSC_SEQ_NO", "0000001");
//    
//    JSONArray req_array = new JSONArray();
//    req_array.add(data);
//    
//    jsonObject.put("REQ_DATA", req_array);

	public JSONObject parseXmlToJson(String xml){
		JSONObject json = XML.toJSONObject(xml);
		return json; 
	}

	public String getHtml(String url) {
		try {
			URL targetUrl = new URL(url);
			BufferedReader reader = new BufferedReader(new InputStreamReader(targetUrl.openStream(), Charset.forName("UTF-8")));
			StringBuilder html = new StringBuilder();
			String current = "";

			while ((current = reader.readLine()) != null) {
				html.append(current);
			}

			reader.close();
			return html.toString();

		} catch (MalformedURLException e) {
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}

		return null;
	}
}